<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Trivia Main Page</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

</head>

<body>

    <nav>
        <div class="nav-wrapper #ffffff white center-align">
          <a href="#" class="brand-logo #000000 black-text center">Trivia Go</a>
          <ul id="nav-mobile" class="right hide-on-med-and-down #ffffff white center">
      </nav>
      <div class="center-align">
        <a class="waves-effect waves-light btn-large" id="startGame" href="/play">Play</a>
        <a class="waves-effect waves-light btn-large" id="scoreCard" href="/scores">Scores</a>
      </div>
    
  <button id="ask">Ask</button>
  <br>
  <hr>
  <div id="questions"></div>
  <br>
  <hr>
  <form id="button-form">
    <!-- 
      <label>True 
          <input type="radio" name="button" value="true" />
       </label> 
       <label>False
          <input type="radio" name="button" value="false" />
       </label>
       <button id="submit">Submit</button> -->


    <button id="False" value="False">False</button>
    <button id="True" value="True">True</button>
    <br>
    <hr>

  </form>

  <div id="answers">
  </div>

  <script type="text/javascript">
    $("#ask").on("click", function () {

          var queryURL = "https://opentdb.com/api.php?amount=9&difficulty=medium&type=boolean";

          var correct;
          var incorrect;
          var counter;
          var gameData;

          // Perfoming an AJAX GET request to our queryURL
          $.ajax({
              url: queryURL,
              method: "GET"
            })
            // After the data from the AJAX request comes back
            .then(function (response) {
              correct = 0;
              incorrect = 0;
              counter = 0;
              gameData = response.results;
              

              displayQuestion(counter);
            });
            //switched these two counters
          function displayQuestion(counter) {
            console.log(gameData[counter].question);
            var question = gameData[counter].question;
            $("#questions").html(counter + 1+". " + question);
          }
        

          $("#button-form button").on("click", function (event) {
            event.preventDefault()

            user = $(this).val();
            // console.log(gameData[counter].correct_answer);  
            if (user === gameData[counter].correct_answer) {
              setInterval(function (correct) {
                $("#answers").html("Correct!");
                correct++;
                
              }, 3000);
              counter++;
              displayQuestion(counter);
            } else {
              setInterval(function (incorrect) {
                $("#answers").html("Incorrect!");
                incorrect++;

                // console.log(incorrect);
              }, 3000);
              counter++;
              displayQuestion(counter);

              if (counter > 9) {
                $.ajax({
                  method: POST,
                  url: "/api/c/" + correct + "/i/" + incorrect
                  // url: `/api/c/${correct}/i/${incorrect}`
                }).then( 
                  console.log("response submitted")
                )
              } else {
                displayQuestion(counter)
              }
            };

          });
          });
  </script>
</body>

</html>